window.indexData={1:[{name:"cookie",url:"avalon.oniui/cookie/avalon.cookie.doc.html",title:"cookie",des:"暂无描述",cover:"doc/img/cookie.png"},{name:"roleselect",url:"avalon.oniui/roleselect/avalon.roleselect.doc.html",title:"roleselect组件",des:"roleselect组件，以左右列表形式展示实现的复选组件",cover:"doc/img/roleselect.png"}],2:[{name:"resizable",url:"avalon.oniui/resizable/avalon.resizable.doc.html",title:"resizable",des:"暂无描述",cover:"doc/img/resizable.png"}],3:[{name:"checkboxlist",url:"avalon.oniui/checkboxlist/avalon.checkboxlist.doc.html",title:"checkboxlist文档说明",des:"通过checkboxlist可以方便的实现选框的全选、全不选，并可通过简单配置进行选中操作的回调处理，也可以通过多种方式来提供渲染选项视图所需要的数据",cover:"doc/img/checkboxlist.png"},{name:"notice",url:"avalon.oniui/notice/avalon.notice.doc.html",title:"notice文档说明",des:"notice组件用来向用户显示一些提示信息",cover:"doc/img/notice.png"},{name:"scrollspy",url:"avalon.oniui/scrollspy/avalon.scrollspy.doc.html",title:"scrollspy组件",des:"scrollspy组件，可通过监听元素原生的scroll事件或者结合scrollbar组件使用时，监听其scroll，根据scrollTop，scrollLeft计算判定配置指定的panel list应该切换到什么位置",cover:"doc/img/scrollspy.png"},{name:"slider",url:"avalon.oniui/slider/avalon.slider.doc.html",title:"slider文档说明",des:"slider组件用来拖动手柄选择数值，可以水平拖动、垂直拖动、设置range使得两边都可以拖动，或者根据设置的步长更新滑块数值",cover:"doc/img/slider.png"}],4:[{name:"accordion",url:"avalon.oniui/accordion/avalon.accordion.doc.html",title:"accordion文档说明",des:"accordion组件是在有限的区域显示可折叠内容面板的信息，通过不同的配置选项和丰富的api可以灵活的设置accordion,实现比如嵌套accordion的效果",cover:"doc/img/accordion.png"},{name:"datepicker",url:"avalon.oniui/datepicker/avalon.datepicker.doc.html",title:"datepicker文档说明",des:"datepicker组件方便快速创建功能齐备的日历组件，通过不同的配置日历可以满足显示多个月份、通过prev、next切换月份、或者通过下拉选择框切换日历的年份、月份，当然也可以手动输入日期，日历组件也会根据输入域中的日期值高亮显示对应日期等等各种需求",cover:"doc/img/datepicker.png"},{name:"dialog",url:"avalon.oniui/dialog/avalon.dialog.doc.html",title:"dialog文档说明",des:"dialog组件提供弹窗显示或者隐藏,通过简单配置可以水平居中显示dialog弹窗，此组件支持弹窗中再弹窗，也可以用来模拟alert的行为，非常方便",cover:"doc/img/dialog.png"},{name:"menu",url:"avalon.oniui/menu/avalon.menu.doc.html",title:"menu组件",des:"menu组件，实现扫描dom元素或者设置传参生成级联菜单的组件，注意扫描dom情形下，会销毁原有的dom，且会忽略所有的ol，ul，li元素上原有的绑定",cover:"doc/img/menu.png"},{name:"textbox",url:"avalon.oniui/textbox/avalon.textbox.doc.html",title:"textbox文档说明",des:"通过给输入域input、textarea设置不同的配置项可以使表单拥有舒服的视觉效果，也可以使其具有提示补全功能",cover:"doc/img/textbox.png"}],5:[{name:"progressbar",url:"avalon.oniui/progressbar/avalon.progressbar.doc.html",title:"progressbar组件",des:"progressbar组件，可以通过接口控制或者随机模拟进度条效果，支持条形，圆形，倒计时等效果功能",cover:"doc/img/progressbar.png"},{name:"spinner",url:"avalon.oniui/spinner/avalon.spinner.doc.html",title:"spinner文档说明",des:"spinner组件是用来增强输入框的能力，使其可以通过上下按钮或者键盘上的up、down键来改变输入域的数值，而且确保输入域始终是数值字符，非数值字符无效，组件会默认将非数值字符转换为最近一次的输入域数值",cover:"doc/img/spinner.png"},{name:"store",url:"avalon.oniui/store/avalon.store.doc.html",title:"分页组件",des:"暂无描述",cover:"doc/img/store.png"}],6:[{name:"flipswitch",url:"avalon.oniui/flipswitch/avalon.flipswitch.doc.html",title:"flipswitch组件",des:"flipswitch组件，将checkbox表单元素转化成富UI的开关",cover:"doc/img/flipswitch.png"},{name:"miniswitch",url:"avalon.oniui/miniswitch/avalon.miniswitch.doc.html",title:"miniswitch文档说明",des:"miniswitch基于switchdropdown实现图标式下拉开关。",cover:"doc/img/miniswitch.png"},{name:"pager",url:"avalon.oniui/pager/avalon.pager.doc.html",title:"分页组件",des:"暂无描述",cover:"doc/img/pager.png"},{name:"tab",url:"avalon.oniui/tab/avalon.tab.doc.html",title:"tab组件",des:"tab组件，实现扫描DOM结构或者接受数组传参，生成tab，支持click、mouseenter事件响应切换，支持mouseenter情形延迟响应切换，支持click情形tab选中情况下再次点击回调，支持自动切换效果，支持tab增删禁用启用并可混合设置同步tab可删除状态，支持混合配制panel内容类型并支持panel内容是ajax配置回调，注意扫描dom情形下，会销毁原有的dom，且会忽略所有的ol，ul，li元素上原有的绑定",cover:"doc/img/tab.png"}],7:[{name:"at",url:"avalon.oniui/at/avalon.at.doc.html",title:"avalon类似新浪微博的@提示插件",des:"暂无描述",cover:"doc/img/at.png"},{name:"dropdown",url:"avalon.oniui/dropdown/avalon.dropdown.doc.html",title:"dropdown文档说明",des:"dropdown基于avalon对普通select控件进行扩展，支持通过data初始化下拉选项，使用内置的scroll控件。",cover:"doc/img/dropdown.png"},{name:"hotkeys",url:"avalon.oniui/hotkeys/avalon.hotkeys.doc.html",title:"热键绑定",des:"暂无描述",cover:"doc/img/hotkeys.png"},{name:"simplegrid",url:"avalon.oniui/simplegrid/avalon.simplegrid.doc.html",title:"grid文档",des:"暂无描述",cover:"doc/img/simplegrid.png"},{name:"tooltip",url:"avalon.oniui/tooltip/avalon.tooltip.doc.html",title:"tooltip组件",des:"tooltip组件，给一个元素或者给元素里满足配置条件的系列元素添加一个富UI及交互的气泡提示框",cover:"doc/img/tooltip.png"}],8:[{name:"position",url:"avalon.oniui/position/avalon.position.doc.html",title:"position2组件",des:"暂无描述",cover:"doc/img/position.png"},{name:"scrollbar",url:"avalon.oniui/scrollbar/avalon.scrollbar.doc.html",title:"scrollbar组件",des:"scrollbar组件，自定义滚动条样式",cover:"doc/img/scrollbar.png"},{name:"switchdropdown",url:"avalon.oniui/switchdropdown/avalon.switchdropdown.doc.html",title:"swtichdropdown文档说明",des:"switchdropdown基于dropdown实现下拉式开关。",cover:"doc/img/switchdropdown.png"}],9:[{name:"draggable",url:"avalon.oniui/draggable/avalon.draggable.doc.html",title:"拖动组件",des:"暂无描述",cover:"doc/img/draggable.png"},{name:"preview",url:"avalon.oniui/preview/avalon.preview.doc.html",title:"图片预览组件",des:"暂无描述",cover:"doc/img/preview.png"}]},function(DOC){function noop(){}function log(a){window.console&&avalon.config.debug&&console.log(W3C?a:a+"")}function getType(obj){return null==obj?String(obj):"object"==typeof obj||"function"==typeof obj?class2type[serialize.call(obj)]||"object":typeof obj}function isWindow(obj){return rwindow.test(serialize.call(obj))}function resetNumber(a,n,end){return a=a!==+a||a%1?end?n:0:0>a?-1*a>=n?0:a+n:a>n?n:a}function oneObject(array,val){"string"==typeof array&&(array=array.match(rword)||[]);for(var result={},value=void 0!==val?val:1,i=0,n=array.length;n>i;i++)result[array[i]]=value;return result}function generateID(){return"avalon"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}function isArrayLike(obj){if(obj&&"object"==typeof obj&&!avalon.isWindow(obj)){var n=obj.length;if(+n===n&&!(n%1)&&n>=0)try{return{}.propertyIsEnumerable.call(obj,"length")===!1?Array.isArray(obj)||/^\s?function/.test(obj.item||obj.callee):!0}catch(e){return!0}}return!1}function modelFactory(scope,model){if(Array.isArray(scope)){var arr=scope.concat();scope.length=0;var collection=Collection(scope);return collection.push.apply(collection,arr),collection}if("number"==typeof scope.nodeType)return scope;var vmodel={};model=model||{};for(var name,accessingProperties={},normalProperties={},computedProperties=[],watchProperties=arguments[2]||{},skipArray=scope.$skipArray,i=0;name=skipProperties[i++];)"string"!=typeof name&&log("warning:$skipArray["+name+"] must be a string"),delete scope[name],normalProperties[name]=!0;if(Array.isArray(skipArray))for(var name,i=0;name=skipArray[i++];)normalProperties[name]=!0;for(var i in scope)loopModel(i,scope[i],model,normalProperties,accessingProperties,computedProperties,watchProperties);vmodel=defineProperties(vmodel,descriptorFactory(accessingProperties),normalProperties);for(var name in normalProperties)vmodel[name]=normalProperties[name];watchProperties.vmodel=vmodel,vmodel.$model=model,vmodel.$events={},vmodel.$id=generateID(),vmodel.$accessors=accessingProperties,vmodel[subscribers]=[];for(var i in Observable){var fn=Observable[i];W3C||(fn=fn.bind(vmodel)),vmodel[i]=fn}vmodel.hasOwnProperty=function(name){return name in vmodel.$model};for(var fn,i=0;fn=computedProperties[i++];)Registry[expose]=fn,fn(),collectSubscribers(fn),delete Registry[expose];return vmodel}function safeFire(a,b,c,d){a.$events&&Observable.$fire.call(a,b,c,d)}function loopModel(name,val,model,normalProperties,accessingProperties,computedProperties,watchProperties){if(model[name]=val,normalProperties[name]||val&&val.nodeType)return normalProperties[name]=val;if("$"===name.charAt(0)&&!watchProperties[name])return normalProperties[name]=val;var valueType=getType(val);if("function"===valueType)return normalProperties[name]=val;var accessor,oldArgs;if("object"===valueType&&"function"==typeof val.get&&Object.keys(val).length<=2){var setter=val.set,getter=val.get;accessor=function(newValue){var vmodel=watchProperties.vmodel,value=model[name],preValue=value;if(!arguments.length)return avalon.openComputedCollect&&collectSubscribers(accessor),newValue=model[name]=getter.call(vmodel),isEqual(value,newValue)||(oldArgs=void 0,safeFire(vmodel,name,newValue,preValue)),newValue;if(!stopRepeatAssign){if("function"==typeof setter){var backup=vmodel.$events[name];vmodel.$events[name]=[],setter.call(vmodel,newValue),vmodel.$events[name]=backup}isEqual(oldArgs,newValue)||(oldArgs=newValue,newValue=model[name]=getter.call(vmodel),withProxyCount&&updateWithProxy(vmodel.$id,name,newValue),notifySubscribers(accessor),safeFire(vmodel,name,newValue,preValue))}},computedProperties.push(accessor)}else rcomplexType.test(valueType)?(accessor=function(newValue){var realAccessor=accessor.$vmodel,preValue=realAccessor.$model;if(!arguments.length)return collectSubscribers(realAccessor),realAccessor;if(!stopRepeatAssign&&!isEqual(preValue,newValue)){newValue=accessor.$vmodel=updateVModel(realAccessor,newValue,valueType);var fn=rebindings[newValue.$id];fn&&fn();var parent=watchProperties.vmodel;model[name]=newValue.$model,notifySubscribers(realAccessor),safeFire(parent,name,model[name],preValue)}},accessor.$vmodel=val.$model?val:modelFactory(val,val),model[name]=accessor.$vmodel.$model):(accessor=function(newValue){var preValue=model[name];if(!arguments.length)return collectSubscribers(accessor),preValue;if(!isEqual(preValue,newValue)){model[name]=newValue;var vmodel=watchProperties.vmodel;withProxyCount&&updateWithProxy(vmodel.$id,name,newValue),notifySubscribers(accessor),safeFire(vmodel,name,newValue,preValue)}},model[name]=val);accessor[subscribers]=[],accessingProperties[name]=accessor}function updateWithProxy($id,name,val){var pool=withProxyPool[$id];pool&&pool[name]&&(pool[name].$val=val)}function updateVModel(a,b,valueType){if("array"===valueType){if(!Array.isArray(b))return a;var bb=b.concat();return a.clear(),a.push.apply(a,bb),a}var iterators=a[subscribers]||[];withProxyPool[a.$id]&&(withProxyCount--,delete withProxyPool[a.$id]);var ret=modelFactory(b);return rebindings[ret.$id]=function(data){for(;data=iterators.shift();)!function(el){el.type&&avalon.nextTick(function(){el.rollback&&el.rollback(),bindingHandlers[el.type](el,el.vmodels)})}(data);delete rebindings[ret.$id]},ret}function VBMediator(accessingProperties,name,value){var accessor=accessingProperties[name];if("function"==typeof accessor){if(3!==arguments.length)return accessor();accessor(value)}}function iterator(vars,body,ret){var fun="for(var "+vars+"i=0,n = this.length; i < n; i++){"+body.replace("_","((i in this) && fn.call(scope,this[i],i,this))")+"}"+ret;return Function("fn,scope",fun)}function fixContains(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1}function kernel(settings){for(var p in settings)if(ohasOwn.call(settings,p)){var val=settings[p];"function"==typeof kernel.plugins[p]?kernel.plugins[p](val):"object"==typeof kernel[p]?avalon.mix(kernel[p],val):kernel[p]=val}return this}function escapeRegExp(target){return(target+"").replace(rregexp,"\\$&")}function hyphen(target){return target.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function camelize(target){return target.indexOf("-")<0&&target.indexOf("_")<0?target:target.replace(/[-_][^-_]/g,function(match){return match.charAt(1).toUpperCase()})}function parseData(data){try{data="true"===data?!0:"false"===data?!1:"null"===data?null:+data+""===data?+data:rbrace.test(data)?parseJSON(data):data}catch(e){}return data}function getWindow(node){return node.window&&node.document?node:9===node.nodeType?node.defaultView||node.parentWindow:!1}function showHidden(node,array){if(node.offsetWidth<=0){if(rdisplayswap.test(cssHooks["@:get"](node,"display"))){var obj={node:node};for(var name in cssShow)obj[name]=node.style[name],node.style[name]=cssShow[name];array.push(obj)}var parent=node.parentNode;parent&&1==parent.nodeType&&showHidden(parent,array)}}function getValType(el){var ret=el.tagName.toLowerCase();return"input"===ret&&/checkbox|radio/.test(el.type)?"checked":ret}function registerSubscriber(data){Registry[expose]=data,avalon.openComputedCollect=!0;var fn=data.evaluator;if(fn)if("duplex"===data.type)data.handler();else try{data.handler(fn.apply(0,data.args),data.element,data)}catch(e){delete data.evaluator,3===data.nodeType&&(kernel.commentInterpolate?data.element.replaceChild(DOC.createComment(data.value),data.node):data.node.data=openTag+data.value+closeTag),log("warning:evaluator of ["+data.value+"] throws error!")}else data();avalon.openComputedCollect=!1,delete Registry[expose]}function collectSubscribers(accessor){if(Registry[expose]){var list=accessor[subscribers];list&&avalon.Array.ensure(list,Registry[expose])}}function notifySubscribers(accessor){var list=accessor[subscribers];if(list&&list.length)for(var fn,args=aslice.call(arguments,1),i=list.length;fn=list[--i];){var remove,el=fn.element;el&&!avalon.contains(ifSanctuary,el)&&(remove="number"==typeof el.sourceIndex?0===el.sourceIndex:!avalon.contains(root,el)),remove?(list.splice(i,1),log("debug: remove "+fn.name)):"function"==typeof fn?fn.apply(0,args):fn.getter?fn.handler.apply(fn,args):fn.handler(fn.evaluator.apply(0,fn.args||[]),el,fn)}}function checkScan(elem,callback){var innerHTML=0/0,id=setInterval(function(){var currHTML=elem.innerHTML;currHTML===innerHTML?(clearInterval(id),callback()):innerHTML=currHTML},interval)}function scanTag(elem,vmodels,node){var a=elem.getAttribute(prefix+"skip");if(!elem.getAttributeNode)return log("warning "+elem.tagName+" no getAttributeNode method");var b=elem.getAttributeNode(prefix+"important"),c=elem.getAttributeNode(prefix+"controller");if("string"!=typeof a){if(node=b||c){var newVmodel=VMODELS[node.value];if(!newVmodel)return;vmodels=node===b?[newVmodel]:[newVmodel].concat(vmodels),elem.removeAttribute(node.name),avalon(elem).removeClass(node.name)}scanAttr(elem,vmodels)}}function scanNodes(parent,vmodels){for(var node=parent.firstChild;node;){var nextNode=node.nextSibling,nodeType=node.nodeType;1===nodeType?scanTag(node,vmodels):3===nodeType&&rexpr.test(node.data)?scanText(node,vmodels):kernel.commentInterpolate&&8===nodeType&&!rexpr.test(node.nodeValue)&&scanText(node,vmodels),node=nextNode}}function scanText(textNode,vmodels){var bindings=[];if(8===textNode.nodeType){var leach=[],value=trimFilter(textNode.nodeValue,leach),token={expr:!0,value:value};leach.length&&(token.filters=leach);var tokens=[token]}else tokens=scanExpr(textNode.data);if(tokens.length){for(var token,i=0;token=tokens[i++];){var node=DOC.createTextNode(token.value);if(token.expr){var filters=token.filters,binding={type:"text",node:node,nodeType:3,value:token.value,filters:filters};filters&&-1!==filters.indexOf("html")&&(avalon.Array.remove(filters,"html"),binding.type="html",binding.replaceNodes=[node],filters.length||delete bindings.filters),bindings.push(binding)}hyperspace.appendChild(node)}textNode.parentNode.replaceChild(hyperspace,textNode),bindings.length&&executeBindings(bindings,vmodels)}}function scanAttr(elem,vmodels){for(var match,attr,attributes=getAttributes?getAttributes(elem):elem.attributes,bindings=[],msData={},i=0;attr=attributes[i++];)if(attr.specified&&(match=attr.name.match(rmsAttr))){var type=match[1],param=match[2]||"";if(msData[attr.name]=attr.value,ons[type]&&(param=type,type="on"),"function"==typeof bindingHandlers[type]){var binding={type:type,param:param,element:elem,name:match[0],value:attr.value,priority:type in priorityMap?priorityMap[type]:10*type.charCodeAt(0)+(Number(param)||0)};"if"===type&&param.indexOf("loop")>-1&&(binding.priority+=100),vmodels.length&&(bindings.push(binding),"widget"===type&&(elem.msData=elem.msData||msData))}}bindings.sort(function(a,b){return a.priority-b.priority}),msData["ms-checked"]&&msData["ms-duplex"]&&log("warning!一个元素上不能同时定义ms-checked与ms-duplex");var firstBinding=bindings[0]||{};switch(firstBinding.type){case"if":case"repeat":case"widget":executeBindings([firstBinding],vmodels);break;default:executeBindings(bindings,vmodels),!stopScan[elem.tagName]&&rbind.test(elem.innerHTML.replace(rlt,"<").replace(rgt,">"))&&scanNodes(elem,vmodels)}elem.patchRepeat&&(elem.patchRepeat(),elem.patchRepeat=null)}function executeBindings(bindings,vmodels){for(var data,i=0;data=bindings[i++];)data.vmodels=vmodels,bindingHandlers[data.type](data,vmodels),data.evaluator&&data.name&&data.element.removeAttribute(data.name);bindings.length=0}function trimFilter(value,leach){return value.indexOf("|")>0&&(value=value.replace(r11a,"U2hvcnRDaXJjdWl0"),value=value.replace(rfilters,function(c,d,e){return leach.push(d+(e||"")),""}),value=value.replace(r11b,"||")),value}function scanExpr(str){for(var value,stop,tokens=[],start=0;;){if(stop=str.indexOf(openTag,start),-1===stop)break;if(value=str.slice(start,stop),value&&tokens.push({value:value,expr:!1}),start=stop+openTag.length,stop=str.indexOf(closeTag,start),-1===stop)break;if(value=str.slice(start,stop)){var leach=[];value=trimFilter(value,leach),tokens.push({value:value,expr:!0,filters:leach.length?leach:void 0})}start=stop+closeTag.length}return value=str.slice(start),value&&tokens.push({value:value,expr:!1}),tokens}function addAssign(vars,scope,name,duplex){for(var prop,ret=[],prefix=" = "+name+".",i=vars.length;prop=vars[--i];)scope.hasOwnProperty&&scope.hasOwnProperty(prop)&&(ret.push(prop+prefix+prop),"duplex"===duplex&&(vars.get=name+"."+prop),vars.splice(i,1));return ret}function uniqVmodels(arr){var uniq={};return arr.filter(function(el){return uniq[el.$id]?void 0:(uniq[el.$id]=1,!0)})}function createCache(maxLength){function cache(key,value){return keys.push(key)>maxLength&&delete cache[keys.shift()],cache[key]=value}var keys=[];return cache}function parseExpr(code,scopes,data,four){var dataType=data.type,filters="html"==dataType||"text"===dataType?data.filters:"",exprId=scopes.map(function(el){return el.$id.replace(rproxy,"$1")})+code+dataType+filters,vars=getVariables(code).concat(),assigns=[],names=[],args=[],prefix="";scopes=uniqVmodels(scopes);for(var i=0,sn=scopes.length;sn>i;i++)if(vars.length){var name="vm"+expose+"_"+i;names.push(name),args.push(scopes[i]),assigns.push.apply(assigns,addAssign(vars,scopes[i],name,four))}if(assigns.length||"duplex"!==four){filters&&args.push(avalon.filters),data.args=args;var fn=cacheExprs[exprId];if(fn)return void(data.evaluator=fn);var prefix=assigns.join(", ");if(prefix&&(prefix="var "+prefix),filters){code="\nvar ret"+expose+" = "+code;var fargs,textBuffer=[];textBuffer.push(code,"\r\n");for(var fname,i=0;fname=data.filters[i++];){var start=fname.indexOf("(");-1!==start?(fargs=fname.slice(start+1,fname.lastIndexOf(")")).trim(),fargs=","+fargs,fname=fname.slice(0,start).trim()):fargs="",textBuffer.push(" if(filters",expose,".",fname,"){\n	try{\nret",expose," = filters",expose,".",fname,"(ret",expose,fargs,")\n	}catch(e){} \n}\n")}code=textBuffer.join(""),code+="\nreturn ret"+expose,names.push("filters"+expose)}else{if("duplex"===dataType){var _body="'use strict';\nreturn function(vvv){\n	"+prefix+";\n	if(!arguments.length){\n		return "+code+"\n	}\n	"+(rduplex.test(code)?code:vars.get)+"= vvv;\n} ";try{fn=Function.apply(noop,names.concat(_body)),data.evaluator=cacheExprs(exprId,fn)}catch(e){log("debug: parse error,"+e.message)}return}if("on"===dataType){code=code.replace("(",".call(this,"),"$event"===four&&names.push(four),code="\nreturn "+code+";";var lastIndex=code.lastIndexOf("\nreturn"),header=code.slice(0,lastIndex),footer=code.slice(lastIndex);code=header+"\nif(avalon.openComputedCollect) return ;"+footer}else code="\nreturn "+code+";"}try{fn=Function.apply(noop,names.concat("'use strict';\n"+prefix+code)),data.evaluator=cacheExprs(exprId,fn)}catch(e){log("debug: parse error,"+e.message)}finally{vars=textBuffer=names=null}}}function parseExprProxy(code,scopes,data,tokens){if(Array.isArray(tokens)){var array=tokens.map(function(token){var tmpl={};return token.expr?parseExpr(token.value,scopes,tmpl)||tmpl:token.value});data.evaluator=function(){for(var el,ret="",i=0;el=array[i++];)ret+="string"==typeof el?el:el.evaluator.apply(0,el.args);return ret},data.args=[]}else parseExpr(code,scopes,data,tokens);data.evaluator&&(data.handler=bindingExecutors[data.handlerName||data.type],data.evaluator.toString=function(){return data.type+" binding to eval("+code+")"},registerSubscriber(data))}function parseDisplay(nodeName,val){if(nodeName=nodeName.toLowerCase(),!cacheDisplay[nodeName]){var node=DOC.createElement(nodeName);root.appendChild(node),val=W3C?getComputedStyle(node,null).display:node.currentStyle.display,root.removeChild(node),cacheDisplay[nodeName]=val}return cacheDisplay[nodeName]}function onTree(){if(!this.disabled&&this.oldValue!==this.value){var event=DOC.createEvent("Event");event.initEvent("input",!0,!0),this.dispatchEvent(event)}}function ticker(){for(var n=ribbon.length-1;n>=0;n--){var el=ribbon[n];avalon.contains(root,el)?el.onTree&&el.onTree():el.msRetain||(el.offTree&&el.offTree(),ribbon.splice(n,1))}ribbon.length||clearInterval(TimerID)}function launchImpl(el){1===ribbon.push(el)&&(TimerID=setInterval(ticker,30))}function newSetter(newValue){if(oldSetter.call(this,newValue),newValue!==this.oldValue){var event=DOC.createEvent("Events");event.initEvent("input",!0,!0),this.dispatchEvent(event)}}function fixEvent(event){var ret={};for(var i in event)ret[i]=event[i];var target=ret.target=event.srcElement;if(0===event.type.indexOf("key"))ret.which=null!=event.charCode?event.charCode:event.keyCode;else if(/mouse|click/.test(event.type)){var doc=target.ownerDocument||DOC,box="BackCompat"===doc.compatMode?doc.body:doc.documentElement;ret.pageX=event.clientX+(box.scrollLeft>>0)-(box.clientLeft>>0),ret.pageY=event.clientY+(box.scrollTop>>0)-(box.clientTop>>0)}return ret.timeStamp=new Date-0,ret.originalEvent=event,ret.preventDefault=function(){event.returnValue=!1},ret.stopPropagation=function(){event.cancelBubble=!0},ret}function Collection(model){var array=[];array.$id=generateID(),array[subscribers]=[],array.$model=model,array.$events={},array._=modelFactory({length:model.length}),array._.$watch("length",function(a,b){array.$fire("length",a,b)});for(var i in Observable)array[i]=Observable[i];return avalon.mix(array,CollectionPrototype),array}function convert(val){return rcomplexType.test(avalon.type(val))&&(val=val.$id?val:modelFactory(val,val)),val}function expelFromSanctuary(parent){for(var comment,comments=queryComments(parent),i=0;comment=comments[i++];)"ms-if"==comment.nodeValue&&cinerator.appendChild(comment.elem);for(;comment=parent.firstChild;)cinerator.appendChild(comment);cinerator.innerHTML=""}function iteratorCallback(args){var callback=getBindingCallback(this.callbackElement,this.callbackName,this.vmodels);if(callback){var parent=this.parent;checkScan(parent,function(){callback.apply(parent,args)})}}function shimController(data,transation,spans,proxy){function fn(){if(delete VMODELS[id],data.group=1,!data.fastRepeat){for(data.group=span.childNodes.length,span.parentNode.removeChild(span);span.firstChild;)transation.appendChild(span.firstChild);void 0!==fn.node&&fn.parent.insertBefore(transation,fn.node)}}var tview=data.template.cloneNode(!0),id=proxy.$id,span=tview.firstChild;return data.fastRepeat||(span=DOC.createElement("msloop"),span.style.display="none",span.appendChild(tview)),span.setAttribute("ms-controller",id),spans.push(span),transation.appendChild(span),proxy.$outer=data.$outer,VMODELS[id]=proxy,span.patchRepeat=fn}function getLocatedNode(parent,data,pos){if(data.startRepeat){var ret=data.startRepeat,end=data.endRepeat;pos+=1;for(var i=0;pos>i;i++)if(ret=ret.nextSibling,ret==end)return end;return ret}return parent.childNodes[data.group*pos]||null}function removeView(node,group,n){for(var length=group*(n||1),view=hyperspace;--length>=0;){var nextSibling=node.nextSibling;if(view.appendChild(node),node=nextSibling,!node)break}return view}function createWithProxy(key,val,$outer){var proxy=modelFactory({$key:key,$outer:$outer,$val:val},0,{$val:1,$key:1});return proxy.$id="$proxy$with"+Math.random(),proxy}function getEachProxy(index,item,data,last){var proxy,param=data.param||"el",source={$remove:function(){return data.getter().removeAt(proxy.$index)},$itemName:param,$index:index,$outer:data.$outer,$first:0===index,$last:index===last};source[param]=item;for(var i=0,n=eachProxyPool.length;n>i;i++){var proxy=eachProxyPool[i];if(proxy.hasOwnProperty(param)){for(var i in source)proxy[i]=source[i];return eachProxyPool.splice(i,1),proxy}}return rcomplexType.test(avalon.type(item))&&(source.$skipArray=[param]),proxy=modelFactory(source,0,watchEachOne),proxy.$id="$proxy$"+data.type+Math.random(),proxy}function recycleEachProxy(proxy){var obj=proxy.$accessors,name=proxy.$itemName;["$index","$last","$first"].forEach(function(prop){obj[prop][subscribers].length=0}),proxy[name][subscribers]&&(proxy[name][subscribers].length=0),eachProxyPool.unshift(proxy)>kernel.maxRepeatSize&&eachProxyPool.pop()}function fireReady(){DOC.body&&(modules["ready!"].state=2,innerRequire.checkDeps(),fireReady=noop)}function doScrollCheck(){try{root.doScroll("left"),fireReady()}catch(e){setTimeout(doScrollCheck)}}var prefix="ms-",expose=new Date-0,subscribers="$"+expose,window=this||(0,eval)("this"),otherRequire=window.require,otherDefine=window.define,stopRepeatAssign=!1,rword=/[^, ]+/g,rnative=/\[native code\]/,rcomplexType=/^(?:object|array)$/,rwindow=/^\[object (Window|DOMWindow|global)\]$/,oproto=Object.prototype,ohasOwn=oproto.hasOwnProperty,serialize=oproto.toString,ap=Array.prototype,aslice=ap.slice,Registry={},W3C=window.dispatchEvent,root=DOC.documentElement,head=DOC.getElementsByTagName("head")[0],hyperspace=DOC.createDocumentFragment(),cinerator=DOC.createElement("div"),class2type={};"Boolean Number String Function Array Date RegExp Object Error".replace(rword,function(name){class2type["[object "+name+"]"]=name.toLowerCase()}),avalon=function(el){return new avalon.init(el)},avalon.init=function(el){this[0]=this.element=el},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=getType,avalon.isWindow=function(obj){return obj?obj==obj.document&&obj.document!=obj:!1},isWindow(window)&&(avalon.isWindow=isWindow),avalon.isPlainObject=function(obj){if("object"!==getType(obj)||obj.nodeType||this.isWindow(obj))return!1;try{if(obj.constructor&&!ohasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},rnative.test(Object.getPrototypeOf)&&(avalon.isPlainObject=function(obj){return!!obj&&"object"==typeof obj&&Object.getPrototypeOf(obj)===oproto}),avalon.mix=avalon.fn.mix=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[1]||{},i++),"object"!=typeof target&&"function"!==getType(target)&&(target={}),i===length&&(target=this,i--);length>i;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(avalon.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&Array.isArray(src)?src:[]):clone=src&&avalon.isPlainObject(src)?src:{},target[name]=avalon.mix(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},avalon.mix({rword:rword,subscribers:subscribers,version:1.3,ui:{},log:log,slice:W3C?function(nodes,start,end){return aslice.call(nodes,start,end)}:function(nodes,start,end){var ret=[],n=nodes.length;start=resetNumber(start,n),end=resetNumber(end,n,1);for(var i=start;end>i;++i)ret[i-start]=nodes[i];return ret},noop:noop,error:function(str,e){throw new(e||Error)(str)},oneObject:oneObject,range:function(start,end,step){step||(step=1),null==end&&(end=start||0,start=0);for(var index=-1,length=Math.max(0,Math.ceil((end-start)/step)),result=Array(length);++index<length;)result[index]=start,start+=step;return result},eventHooks:{},bind:function(el,type,fn,phase){var hooks=avalon.eventHooks,hook=hooks[type];"object"==typeof hook&&(type=hook.type,hook.deel&&(fn=hook.deel(el,fn)));var callback=W3C?fn:function(e){return fn.call(el,fixEvent(e))};return W3C?el.addEventListener(type,callback,!!phase):el.attachEvent("on"+type,callback),callback},unbind:function(el,type,fn,phase){var hooks=avalon.eventHooks,hook=hooks[type],callback=fn||noop;"object"==typeof hook&&(type=hook.type),W3C?el.removeEventListener(type,callback,!!phase):el.detachEvent("on"+type,callback)},css:function(node,name,value){node instanceof avalon&&(node=node[0]);var prop=/[_-]/.test(name)?camelize(name):name;if(name=avalon.cssName(prop)||prop,void 0===value||"boolean"==typeof value){var fn=cssHooks[prop+":get"]||cssHooks["@:get"],val=fn(node,name);return value===!0?parseFloat(val)||0:val}if(""===value)node.style[name]="";else{if(null==value||value!==value)return;isFinite(value)&&!avalon.cssNumber[prop]&&(value+="px"),fn=cssHooks[prop+":set"]||cssHooks["@:set"],fn(node,name,value)}},each:function(obj,fn){if(obj){var i=0;if(isArrayLike(obj))for(var n=obj.length;n>i;i++)fn(i,obj[i]);else for(i in obj)obj.hasOwnProperty(i)&&fn(i,obj[i])}},getWidgetData:function(elem,prefix){var raw=avalon(elem).data(),result={};for(var i in raw)0===i.indexOf(prefix)&&(result[i.replace(prefix,"").replace(/\w/,function(a){return a.toLowerCase()})]=raw[i]);return result},Array:{ensure:function(target,item){return-1===target.indexOf(item)&&target.push(item),target},removeAt:function(target,index){return!!target.splice(index,1).length},remove:function(target,item){var index=target.indexOf(item);return~index?avalon.Array.removeAt(target,index):!1}}}),avalon.nextTick=window.setImmediate?setImmediate.bind(window):function(callback){setTimeout(callback,0)};var VMODELS=avalon.vmodels={};avalon.define=function(id,factory){VMODELS[id]&&log("warning: "+id+" 已经存在于avalon.vmodels中");var scope={$watch:noop};factory(scope);var model=modelFactory(scope);return stopRepeatAssign=!0,factory(model),stopRepeatAssign=!1,model.$id=id,VMODELS[id]=model};var skipProperties=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$accessors,"+subscribers).match(rword),isEqual=Object.is||function(v1,v2){return 0===v1&&0===v2?1/v1===1/v2:v1!==v1?v2!==v2:v1===v2},descriptorFactory=W3C?function(obj){var descriptors={};for(var i in obj)descriptors[i]={get:obj[i],set:obj[i],enumerable:!0,configurable:!0};return descriptors}:function(a){return a},withProxyPool={},withProxyCount=0,rebindings={},defineProperty=Object.defineProperty;try{defineProperty({},"_",{value:"x"});var defineProperties=Object.defineProperties}catch(e){"__defineGetter__"in avalon&&(defineProperty=function(obj,prop,desc){return"value"in desc&&(obj[prop]=desc.value),"get"in desc&&obj.__defineGetter__(prop,desc.get),"set"in desc&&obj.__defineSetter__(prop,desc.set),obj},defineProperties=function(obj,descs){for(var prop in descs)descs.hasOwnProperty(prop)&&defineProperty(obj,prop,descs[prop]);return obj})}if(!defineProperties&&window.VBArray&&(window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function","Dim VBClassBodies",'Set VBClassBodies=CreateObject("Scripting.Dictionary")',"Function findOrDefineVBClass(name,body)","	Dim found",'	found=""',"	For Each key in VBClassBodies","		If body=VBClassBodies.Item(key) Then","			found=key","			Exit For","		End If","	next",'	If found="" Then','		parseVB("Class " + name + body)',"		VBClassBodies.Add name, body","		found=name","	End If","	findOrDefineVBClass=found","End Function"].join("\n"),"VBScript"),defineProperties=function(name,accessingProperties,normalProperties){var className="VBClass"+setTimeout("1"),buffer=[];buffer.push("\r\n	Private [__data__], [__proxy__]","	Public Default Function [__const__](d, p)","		Set [__data__] = d: set [__proxy__] = p","		Set [__const__] = Me","	End Function");for(name in normalProperties)buffer.push("	Public ["+name+"]");buffer.push("	Public [hasOwnProperty]");for(name in accessingProperties)name in normalProperties||buffer.push("	Public Property Let ["+name+"](val"+expose+")",'		Call [__proxy__]([__data__], "'+name+'", val'+expose+")","	End Property","	Public Property Set ["+name+"](val"+expose+")",'		Call [__proxy__]([__data__], "'+name+'", val'+expose+")","	End Property","	Public Property Get ["+name+"]","	On Error Resume Next","		Set["+name+'] = [__proxy__]([__data__],"'+name+'")',"	If Err.Number <> 0 Then","		["+name+'] = [__proxy__]([__data__],"'+name+'")',"	End If","	On Error Goto 0","	End Property");
buffer.push("End Class");var code=buffer.join("\r\n"),realClassName=window.findOrDefineVBClass(className,code);realClassName==className&&window.parseVB(["Function "+className+"Factory(a, b)","	Dim o","	Set o = (New "+className+")(a, b)","	Set "+className+"Factory = o","End Function"].join("\r\n"));var ret=window[realClassName+"Factory"](accessingProperties,VBMediator);return ret}),!"司徒正美".trim){var rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(rtrim,"")}}DOC.documentMode>8&&window.SVGElement&&(Object.defineProperty(SVGElement.prototype,"outerHTML",{get:function(){return(new XMLSerializer).serializeToString(this)}}),Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){var s=this.outerHTML,ropen=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),rclose=new RegExp("</"+this.nodeName+">$","i");return s.replace(ropen,"").replace(rclose,"")}}));var enumerables="propertyIsEnumerable,isPrototypeOf,hasOwnProperty,toLocaleString,toString,valueOf,constructor".split(",");for(var i in{toString:1})enumerables=!1;Object.keys||(Object.keys=function(obj){var result=[];for(var key in obj)obj.hasOwnProperty(key)&&result.push(key);if(enumerables&&obj)for(var i=0;key=enumerables[i++];)obj.hasOwnProperty(key)&&result.push(key);return result}),Array.isArray||(Array.isArray=function(a){return a&&"array"===getType(a)}),noop.bind||(Function.prototype.bind=function(scope){if(arguments.length<2&&void 0===scope)return this;var fn=this,argv=arguments;return function(){var i,args=[];for(i=1;i<argv.length;i++)args.push(argv[i]);for(i=0;i<arguments.length;i++)args.push(arguments[i]);return fn.apply(scope,args)}}),rnative.test([].map)||avalon.mix(ap,{indexOf:function(item,index){var n=this.length,i=~~index;for(0>i&&(i+=n);n>i;i++)if(this[i]===item)return i;return-1},lastIndexOf:function(item,index){var n=this.length,i=null==index?n-1:index;for(0>i&&(i=Math.max(0,n+i));i>=0;i--)if(this[i]===item)return i;return-1},forEach:iterator("","_",""),filter:iterator("r=[],j=0,","if(_)r[j++]=this[i]","return r"),map:iterator("r=[],","r[i]=_","return r"),some:iterator("","if(_)return true","return false"),every:iterator("","if(!_)return false","return true")}),root.contains||(Node.prototype.contains=function(arg){return!!(16&this.compareDocumentPosition(arg))}),DOC.contains||(DOC.contains=function(b){return fixContains(this,b)}),!root.outerHTML&&window.HTMLElement&&HTMLElement.prototype.__defineGetter__("outerHTML",function(){cinerator.textContent="",cinerator.appendChild(this);var str=this.innerHTML;return cinerator.textContent="",str});var openTag,closeTag,rexpr,rexprg,rbind,rregexp=/[-.*+?^${}()|[\]\/\\]/g,plugins={loader:function(builtin){window.define=builtin?innerRequire.define:otherDefine,window.require=builtin?innerRequire:otherRequire},interpolate:function(array){if(openTag=array[0],closeTag=array[1],openTag===closeTag)throw new SyntaxError("openTag!==closeTag");if(array+""=="<!--,-->")kernel.commentInterpolate=!0;else{var test=openTag+"test"+closeTag;if(cinerator.innerHTML=test,cinerator.innerHTML!==test&&cinerator.innerHTML.indexOf("&lt;")>=0)throw new SyntaxError("此定界符不合法");cinerator.innerHTML=""}var o=escapeRegExp(openTag),c=escapeRegExp(closeTag);rexpr=new RegExp(o+"(.*?)"+c),rexprg=new RegExp(o+"(.*?)"+c,"g"),rbind=new RegExp(o+".*?"+c+"|\\sms-")}};kernel.debug=!0,kernel.plugins=plugins,kernel.plugins.interpolate(["{{","}}"]),kernel.paths={},kernel.shim={},kernel.maxRepeatSize=100,avalon.config=kernel;var rnospaces=/\S+/g;avalon.fn.mix({hasClass:function(cls){var node=this[0]||{};return 1===node.nodeType&&node.className?(" "+node.className+" ").indexOf(" "+cls+" ")>-1:!1},addClass:function(cls){var node=this[0]||{};if(cls&&"string"==typeof cls&&1===node.nodeType)if(node.className){var arr=node.className.match(rnospaces);cls.replace(rnospaces,function(a){-1===arr.indexOf(a)&&arr.push(a)}),node.className=arr.join(" ")}else node.className=cls;return this},removeClass:function(cls){var node=this[0]||{};if(cls&&typeof cls>"o"&&1===node.nodeType&&node.className){for(var classNames=(cls||"").match(rnospaces)||[],cl=classNames.length,set=" "+node.className.match(rnospaces).join(" ")+" ",c=0;cl>c;c++)set=set.replace(" "+classNames[c]+" "," ");node.className=set.slice(1,set.length-1)}return this},toggleClass:function(value,stateVal){for(var className,state=stateVal,i=0,classNames=value.match(rnospaces)||[],isBool="boolean"==typeof stateVal;className=classNames[i++];)state=isBool?state:!this.hasClass(className),this[state?"addClass":"removeClass"](className);return this},attr:function(name,value){return 2===arguments.length?(this[0].setAttribute(name,value),this):this[0].getAttribute(name)},data:function(name,value){switch(name="data-"+hyphen(name||""),arguments.length){case 2:return this.attr(name,value),this;case 1:var val=this.attr(name);return parseData(val);case 0:var ret={};return ap.forEach.call(this[0].attributes,function(attr){attr&&(name=attr.name,name.indexOf("data-")||(name=camelize(name.slice(5)),ret[name]=parseData(attr.value)))}),ret}},removeData:function(name){return name="data-"+hyphen(name),this[0].removeAttribute(name),this},css:function(name,value){if(avalon.isPlainObject(name))for(var i in name)avalon.css(this,i,name[i]);else var ret=avalon.css(this,name,value);return void 0!==ret?ret:this},position:function(){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};if(elem)return"fixed"===this.css("position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),"HTML"!==offsetParent[0].tagName&&(parentOffset=offsetParent.offset()),parentOffset.top+=avalon.css(offsetParent[0],"borderTopWidth",!0),parentOffset.left+=avalon.css(offsetParent[0],"borderLeftWidth",!0)),{top:offset.top-parentOffset.top-avalon.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-avalon.css(elem,"marginLeft",!0)}},offsetParent:function(){for(var offsetParent=this[0].offsetParent||root;offsetParent&&"HTML"!==offsetParent.tagName&&"static"===avalon.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return avalon(offsetParent||root)},bind:function(type,fn,phase){return this[0]?avalon.bind(this[0],type,fn,phase):void 0},unbind:function(type,fn,phase){return this[0]&&avalon.unbind(this[0],type,fn,phase),this},val:function(value){var node=this[0];if(node&&1===node.nodeType){var get=0===arguments.length,access=get?":get":":set",fn=valHooks[getValType(node)+access];if(fn)var val=fn(node,value);else{if(get)return(node.value||"").replace(/\r/g,"");node.value=value}}return get?val:this}});var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rvalidchars=/^[\],:{}\s]*$/,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,parseJSON=window.JSON?JSON.parse:function(data){if("string"==typeof data){if(data=data.trim(),data&&rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,"")))return new Function("return "+data)();avalon.error("Invalid JSON: "+data)}};avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){avalon.fn[method]=function(val){var node=this[0]||{},win=getWindow(node),top="scrollTop"===method;return arguments.length?void(win?win.scrollTo(top?avalon(win).scrollLeft():val,top?val:avalon(win).scrollTop()):node[method]=val):win?prop in win?win[prop]:root[method]:node[method]}});var cssHooks=avalon.cssHooks={},prefixes=["","-webkit-","-o-","-moz-","-ms-"],cssMap={"float":"cssFloat",background:"backgroundColor"};if(avalon.cssNumber=oneObject("columnCount,order,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(name,host,camelCase){if(cssMap[name])return cssMap[name];host=host||root.style;for(var i=0,n=prefixes.length;n>i;i++)if(camelCase=camelize(prefixes[i]+name),camelCase in host)return cssMap[name]=camelCase;return null},cssHooks["@:set"]=function(node,name,value){try{node.style[name]=value}catch(e){}},window.getComputedStyle)cssHooks["@:get"]=function(node,name){if(!node||!node.style)throw new Error("getComputedStyle要求传入一个节点 "+node);var ret,styles=getComputedStyle(node,null);return styles&&(ret="filter"===name?styles.getPropertyValue(name):styles[name],""===ret&&(ret=node.style[name])),ret},cssHooks["opacity:get"]=function(node){var ret=cssHooks["@:get"](node,"opacity");return""===ret?"1":ret};else{var rnumnonpx=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,rposition=/^(top|right|bottom|left)$/,ie8=!!window.XDomainRequest,salpha="DXImageTransform.Microsoft.Alpha",border={thin:ie8?"1px":"2px",medium:ie8?"3px":"4px",thick:ie8?"5px":"6px"};cssHooks["@:get"]=function(node,name){var currentStyle=node.currentStyle,ret=currentStyle[name];if(rnumnonpx.test(ret)&&!rposition.test(ret)){var style=node.style,left=style.left,rsLeft=node.runtimeStyle.left;node.runtimeStyle.left=currentStyle.left,style.left="fontSize"===name?"1em":ret||0,ret=style.pixelLeft+"px",style.left=left,node.runtimeStyle.left=rsLeft}return"medium"===ret&&(name=name.replace("Width","Style"),"none"===currentStyle[name]&&(ret="0px")),""===ret?"auto":border[ret]||ret},cssHooks["opacity:set"]=function(node,name,value){node.style.filter="alpha(opacity="+100*value+")",node.style.zoom=1},cssHooks["opacity:get"]=function(node){var alpha=node.filters.alpha||node.filters[salpha],op=alpha?alpha.opacity:100;return op/100+""}}"top,left".replace(rword,function(name){cssHooks[name+":get"]=function(node){var computed=cssHooks["@:get"](node,name);return/px$/.test(computed)?computed:avalon(node).position()[name]+"px"}});var cssShow={position:"absolute",visibility:"hidden",display:"block"},rdisplayswap=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(rword,function(name){var method=name.toLowerCase(),clientProp="client"+name,scrollProp="scroll"+name,offsetProp="offset"+name;cssHooks[method+":get"]=function(node,which,override){var boxSizing="content-box";switch("string"==typeof override&&(boxSizing=override),which="Width"===name?["Left","Right"]:["Top","Bottom"],boxSizing){case"content-box":return node["client"+name]-avalon.css(node,"padding"+which[0],!0)-avalon.css(node,"padding"+which[1],!0);case"padding-box":return node["client"+name];case"border-box":return node["offset"+name];case"margin-box":return node["offset"+name]+avalon.css(node,"margin"+which[0],!0)+avalon.css(node,"margin"+which[1],!0)}},cssHooks[method+"&get"]=function(node){var hidden=[];showHidden(node,hidden);for(var obj,val=cssHooks[method+":get"](node),i=0;obj=hidden[i++];){node=obj.node;for(var n in obj)"string"==typeof obj[n]&&(node.style[n]=obj[n])}return val},avalon.fn[method]=function(value){var node=this[0];if(0===arguments.length){if(node.setTimeout)return node["inner"+name]||node.document.documentElement[clientProp];if(9===node.nodeType){var doc=node.documentElement;return Math.max(node.body[scrollProp],doc[scrollProp],node.body[offsetProp],doc[offsetProp],doc[clientProp])}return cssHooks[method+"&get"](node)}return this.css(method,value)},avalon.fn["inner"+name]=function(){return cssHooks[method+":get"](this[0],void 0,"padding-box")},avalon.fn["outer"+name]=function(includeMargin){return cssHooks[method+":get"](this[0],void 0,includeMargin===!0?"margin-box":"border-box")}}),avalon.fn.offset=function(){var node=this[0],box={left:0,top:0};if(!node||!node.tagName||!node.ownerDocument)return box;var doc=node.ownerDocument,body=doc.body,root=doc.documentElement,win=doc.defaultView||doc.parentWindow;if(!avalon.contains(root,node))return box;"undefined"!=typeof node.getBoundingClientRect&&(box=node.getBoundingClientRect());var clientTop=root.clientTop||body.clientTop,clientLeft=root.clientLeft||body.clientLeft,scrollTop=Math.max(win.pageYOffset||0,root.scrollTop,body.scrollTop),scrollLeft=Math.max(win.pageXOffset||0,root.scrollLeft,body.scrollLeft);return{top:box.top+scrollTop-clientTop,left:box.left+scrollLeft-clientLeft}};var roption=/^<option(?:\s+\w+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s+value[\s=]/i,valHooks={"option:get":function(node){return node.hasAttribute?node.hasAttribute("value")?node.value:node.text.trim():roption.test(node.outerHTML)?node.value:node.text},"select:get":function(node,value){for(var option,options=node.options,index=node.selectedIndex,getter=valHooks["option:get"],one="select-one"===node.type||0>index,values=one?null:[],max=one?index+1:options.length,i=0>index?max:one?index:0;max>i;i++)if(option=options[i],(option.selected||i===index)&&!option.disabled){if(value=getter(option),one)return value;values.push(value)}return values},"select:set":function(node,values,optionSet){values=[].concat(values);for(var el,getter=valHooks["option:get"],i=0;el=node.options[i++];)(el.selected=values.indexOf(getter(el))>=0)&&(optionSet=!0);optionSet||(node.selectedIndex=-1)}},rtagName=/<([\w:]+)/,rxhtml=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rcreate=W3C?/[^\d\D]/:/(<(?:script|link|style|meta|noscript))/gi,scriptTypes=oneObject("text/javascript","text/ecmascript","application/ecmascript","application/javascript","text/vbscript"),rnest=/<(?:tb|td|tf|th|tr|col|opt|leg|cap|area)/,tagHooks={area:[1,"<map>"],param:[1,"<object>"],col:[2,"<table><tbody></tbody><colgroup>","</table>"],legend:[1,"<fieldset>"],option:[1,"<select multiple='multiple'>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>"],td:[3,"<table><tbody><tr>"],_default:W3C?[0,""]:[1,"X<div>"]};tagHooks.optgroup=tagHooks.option,tagHooks.tbody=tagHooks.tfoot=tagHooks.colgroup=tagHooks.caption=tagHooks.thead,tagHooks.th=tagHooks.td;var script=DOC.createElement("script");avalon.parseHTML=function(html){"string"!=typeof html&&(html+=""),html=html.replace(rxhtml,"<$1></$2>").trim();var firstChild,neo,tag=(rtagName.exec(html)||["",""])[1].toLowerCase(),wrap=tagHooks[tag]||tagHooks._default,fragment=hyperspace.cloneNode(!1),wrapper=cinerator;W3C||(html=html.replace(rcreate,"<br class=msNoScope>$1")),wrapper.innerHTML=wrap[1]+html+(wrap[2]||"");var els=wrapper.getElementsByTagName("script");if(els.length)for(var el,i=0;el=els[i++];)(!el.type||scriptTypes[el.type])&&(neo=script.cloneNode(!1),ap.forEach.call(el.attributes,function(attr){attr&&attr.specified&&(neo[attr.name]=attr.value)}),neo.text=el.text,el.parentNode.replaceChild(neo,el));for(i=wrap[0];i--;wrapper=wrapper.lastChild);if(!W3C)for(els=wrapper.getElementsByTagName("br"),i=0;el=els[i++];)el.className&&"msNoScope"===el.className&&el.parentNode.removeChild(el);for(;firstChild=wrapper.firstChild;)fragment.appendChild(firstChild);return fragment},avalon.innerHTML=function(node,html){if(!W3C&&!rcreate.test(html)&&!rnest.test(html))try{return void(node.innerHTML=html)}catch(e){}var a=this.parseHTML(html);this.clearHTML(node).appendChild(a)},avalon.clearHTML=function(node){return expelFromSanctuary(node),node};var Observable={$watch:function(type,callback){if("function"==typeof callback){var callbacks=this.$events[type];callbacks?callbacks.push(callback):this.$events[type]=[callback]}else this.$events=this.$watch.backup;return this},$unwatch:function(type,callback){var n=arguments.length;if(0===n)this.$watch.backup=this.$events,this.$events={};else if(1===n)this.$events[type]=[];else for(var callbacks=this.$events[type]||[],i=callbacks.length;~--i<0;)if(callbacks[i]===callback)return callbacks.splice(i,1);return this},$fire:function(type){for(var callback,callbacks=this.$events[type]||[],all=this.$events.$all||[],args=aslice.call(arguments,1),i=0;callback=callbacks[i++];)callback.apply(this,args);for(var callback,i=0;callback=all[i++];)callback.apply(this,arguments)}};avalon.scan=function(elem,vmodel){elem=elem||root;var vmodels=vmodel?[].concat(vmodel):[];scanTag(elem,vmodels)};var stopScan=oneObject("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase()),interval=W3C?15:50,rmsAttr=/ms-(\w+)-?(.*)/,priorityMap={"if":10,repeat:90,widget:110,each:1400,"with":1500,duplex:2e3,on:3e3},ons=oneObject("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scroll");if(!"1"[0])var cacheAttrs=createCache(512),rattrs=/\s+(ms-[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,rquote=/^['"]/,rtag=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/i,ramp=/&amp;/g,getAttributes=function(elem){if("</"===elem.outerHTML.slice(0,2))return[];var match,k,v,str=elem.outerHTML.match(rtag)[0],attributes=[];if(cacheAttrs[str])return cacheAttrs[str];for(;k=rattrs.exec(str);){v=k[2],v&&(v=(rquote.test(v)?v.slice(1,-1):v).replace(ramp,"&"));var name=k[1].toLowerCase();match=name.match(rmsAttr);var binding={name:name,specified:!0,value:v||""};attributes.push(binding)}return cacheAttrs(str,attributes)};var rfilters=/\|\s*(\w+)\s*(\([^)]*\))?/g,r11a=/\|\|/g,r11b=/U2hvcnRDaXJjdWl0/g,rlt=/&lt;/g,rgt=/&gt;/g,keywords="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",rrexpstr=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,rsplit=/[^\w$]+/g,rkeywords=new RegExp(["\\b"+keywords.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),rnumber=/\b\d[^,]*/g,rcomma=/^,+|,+$/g,cacheVars=createCache(512),getVariables=function(code){if(code=","+code.trim(),cacheVars[code])return cacheVars[code];for(var match=code.replace(rrexpstr,"").replace(rsplit,",").replace(rkeywords,"").replace(rnumber,"").replace(rcomma,"").split(/^$|,+/),vars=[],unique={},i=0;i<match.length;++i){var variable=match[i];unique[variable]||(unique[variable]=vars.push(variable))}return cacheVars(code,vars)},cacheExprs=createCache(256),rduplex=/\w\[.*\]|\w\.\w/,rproxy=/(\$proxy\$[a-z]+)\d+$/;avalon.parseExprProxy=parseExprProxy;var cacheDisplay=oneObject("a,abbr,b,span,strong,em,font,i,kbd","inline");avalon.mix(cacheDisplay,oneObject("div,h1,h2,h3,h4,h5,h6,section,p","block")),avalon.parseDisplay=parseDisplay;var supportDisplay=function(td){return W3C?"table-cell"===getComputedStyle(td,null).display:!0}(DOC.createElement("td")),propMap={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},anomaly="accessKey,allowTransparency,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan,contentEditable,dateTime,defaultChecked,defaultSelected,defaultValue,frameBorder,isMap,longDesc,maxLength,marginWidth,marginHeight,noHref,noResize,noShade,readOnly,rowSpan,tabIndex,useMap,vSpace,valueType,vAlign";anomaly.replace(rword,function(name){propMap[name.toLowerCase()]=name});var rdash=/\(([^)]*)\)/,cssText="<style id='avalonStyle'>.avalonHide{ display: none!important }</style>";head.insertBefore(avalon.parseHTML(cssText),head.firstChild);var rnoscripts=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/gim,rnoscriptText=/<noscript.*?>([\s\S]+?)<\/noscript>/im,getXHR=function(){return new(window.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},getBindingCallback=function(elem,name,vmodels){var callback=elem.getAttribute(name);if(callback)for(var vm,i=0;vm=vmodels[i++];)if(vm.hasOwnProperty(callback)&&"function"==typeof vm[callback])return vm[callback]},cacheTmpls=avalon.templateCache={},ifSanctuary=DOC.createElement("div");ifSanctuary.innerHTML="a";try{ifSanctuary.contains(ifSanctuary.firstChild),avalon.contains=function(a,b){return a.contains(b)}}catch(e){avalon.contains=fixContains}var bindingExecutors=avalon.bindingExecutors={attr:function(val,elem,data){function scanTemplate(text){loaded&&(text=loaded.apply(elem,[text].concat(vmodels))),avalon.innerHTML(elem,text),scanNodes(elem,vmodels),rendered&&checkScan(elem,function(){rendered.call(elem)})}var method=data.type,attrName=data.param;if("css"===method)avalon(elem).css(attrName,val);else if("attr"===method){var toRemove=val===!1||null===val||void 0===val;toRemove?elem.removeAttribute(attrName):W3C?toRemove||elem.setAttribute(attrName,val):(attrName=propMap[attrName]||attrName,toRemove?elem.removeAttribute(attrName):elem[attrName]=val)}else if("include"===method&&val){var vmodels=data.vmodels,rendered=getBindingCallback(elem,"data-include-rendered",vmodels),loaded=getBindingCallback(elem,"data-include-loaded",vmodels);if("src"===data.param)if(cacheTmpls[val])scanTemplate(cacheTmpls[val]);else{var xhr=getXHR();xhr.onreadystatechange=function(){if(4===xhr.readyState){var s=xhr.status;(s>=200&&300>s||304===s||1223===s)&&scanTemplate(cacheTmpls[val]=xhr.responseText)}},xhr.open("GET",val,!0),"withCredentials"in xhr&&(xhr.withCredentials=!0),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.send(null)}else{var el=val&&1==val.nodeType?val:DOC.getElementById(val);if(el){if("NOSCRIPT"===el.tagName&&!el.innerHTML&&!el.fixIE78){var xhr=getXHR();xhr.open("GET",location,!1),xhr.send(null);for(var noscripts=DOC.getElementsByTagName("noscript"),array=(xhr.responseText||"").match(rnoscripts)||[],n=array.length,i=0;n>i;i++){var tag=noscripts[i];tag&&(tag.style.display="none",tag.fixIE78=(array[i].match(rnoscriptText)||["","&nbsp;"])[1])}}avalon.nextTick(function(){scanTemplate(el.fixIE78||el.innerText||el.innerHTML)})}}}else root.hasAttribute||"string"!=typeof val||"src"!==method&&"href"!==method||(val=val.replace(/&amp;/g,"&")),elem[method]=val},"class":function(val,elem,data){var $elem=avalon(elem),method=data.type;if("class"===method&&data.param)$elem.toggleClass(data.param,!!val);else{var toggle=data._evaluator?!!data._evaluator.apply(elem,data._args):!0,className=data._class||val;switch(method){case"class":toggle&&data.oldClass&&$elem.removeClass(data.oldClass),$elem.toggleClass(className,toggle),data.oldClass=className;break;case"hover":case"active":if(!data.init){if("hover"===method)var event1="mouseenter",event2="mouseleave";else elem.tabIndex=elem.tabIndex||-1,event1="mousedown",event2="mouseup",$elem.bind("mouseleave",function(){toggle&&$elem.removeClass(className)});$elem.bind(event1,function(){toggle&&$elem.addClass(className)}),$elem.bind(event2,function(){toggle&&$elem.removeClass(className)}),data.init=1}}}},data:function(val,elem,data){var key="data-"+data.param;val&&"object"==typeof val?elem[key]=val:elem.setAttribute(key,String(val))},checked:function(val,elem,data){var name=data.type;if("enabled"===name)elem.disabled=!val;else{var propName="readonly"===name?"readOnly":name;elem[propName]=!!val}},repeat:function(method,pos,el){if(method){var data=this,group=data.group,pp=data.startRepeat&&data.startRepeat.parentNode;pp&&(data.parent=pp);var parent=data.parent,proxies=data.proxies,transation=hyperspace.cloneNode(!1);if("del"===method||"move"===method)var locatedNode=getLocatedNode(parent,data,pos);switch(method){case"add":for(var arr=el,last=data.getter().length-1,spans=[],lastFn={},i=0,n=arr.length;n>i;i++){var ii=i+pos,proxy=getEachProxy(ii,arr[i],data,last);proxies.splice(ii,0,proxy),lastFn=shimController(data,transation,spans,proxy)}locatedNode=getLocatedNode(parent,data,pos),lastFn.node=locatedNode,lastFn.parent=parent,parent.insertBefore(transation,locatedNode);for(var node,i=0;node=spans[i++];)scanTag(node,data.vmodels);spans=null;break;case"del":for(var proxy,removed=proxies.splice(pos,el),i=0;proxy=removed[i++];)recycleEachProxy(proxy);expelFromSanctuary(removeView(locatedNode,group,el));break;case"index":for(var last=proxies.length-1;el=proxies[pos];pos++)el.$index=pos,el.$first=0===pos,el.$last=pos===last;break;case"clear":if(data.startRepeat)for(;;){var node=data.startRepeat.nextSibling;if(!node||node===data.endRepeat)break;transation.appendChild(node)}else transation=parent;expelFromSanctuary(transation),proxies.length=0;break;case"move":var t=proxies.splice(pos,1)[0];t&&(proxies.splice(el,0,t),transation=removeView(locatedNode,group),locatedNode=getLocatedNode(parent,data,el),parent.insertBefore(transation,locatedNode));break;case"set":var proxy=proxies[pos];proxy&&(proxy[proxy.$itemName]=el);break;case"append":var pool=el,callback=getBindingCallback(data.callbackElement,"data-with-sorted",data.vmodels),keys=[],spans=[],lastFn={};for(var key in pos)pos.hasOwnProperty(key)&&"hasOwnProperty"!==key&&keys.push(key);if(callback){var keys2=callback.call(parent,keys);keys2&&Array.isArray(keys2)&&keys2.length&&(keys=keys2)}for(var key,i=0;key=keys[i++];)"hasOwnProperty"!==key&&(lastFn=shimController(data,transation,spans,pool[key]));lastFn.parent=parent,lastFn.node=data.endRepeat||null,parent.insertBefore(transation,lastFn.node);for(var el,i=0;el=spans[i++];)scanTag(el,data.vmodels);spans=null}iteratorCallback.call(data,arguments)}},html:function(val,elem,data){if(val=null==val?"":val,elem||(elem=data.element=data.node.parentNode),data.replaceNodes){var fragment,nodes;if(11===val.nodeType)fragment=val;else if(1===val.nodeType||val.item)for(nodes=1===val.nodeType?val.childNodes:val.item?val:[],fragment=hyperspace.cloneNode(!0);nodes[0];)fragment.appendChild(nodes[0]);else fragment=avalon.parseHTML(val);var replaceNodes=avalon.slice(fragment.childNodes);elem.insertBefore(fragment,data.replaceNodes[0]||null);for(var node,i=0;node=data.replaceNodes[i++];)elem.removeChild(node);data.replaceNodes=replaceNodes}else avalon.innerHTML(elem,val);avalon.nextTick(function(){scanNodes(elem,data.vmodels)})},"if":function(val,elem,data){var placehoder=data.placehoder;if(val){if(!data.msInDocument){data.msInDocument=!0;try{placehoder.parentNode.replaceChild(elem,placehoder)}catch(e){log("debug: ms-if  "+e.message)}}rbind.test(elem.outerHTML.replace(rlt,"<").replace(rgt,">"))&&scanAttr(elem,data.vmodels)}else data.msInDocument&&(data.msInDocument=!1,elem.parentNode.replaceChild(placehoder,elem),placehoder.elem=elem,ifSanctuary.appendChild(elem))},on:function(callback,elem,data){var fn=data.evaluator,args=data.args,vmodels=data.vmodels;if(callback=data.hasArgs?function(e){return fn.apply(this,args.concat(e))}:function(e){return fn.apply(0,args).call(this,e)},elem.$vmodel=vmodels[0],elem.$vmodels=vmodels,data.param=data.param.replace(/-\d+$/,""),"function"==typeof data.specialBind)data.specialBind(elem,callback);else var removeFn=avalon.bind(elem,data.param,callback);data.rollback=function(){"function"==typeof data.specialUnbind?data.specialUnbind():avalon.unbind(elem,data.param,removeFn)},data.evaluator=data.handler=noop},text:function(val,elem,data){val=null==val?"":val;var node=data.node;if(3===data.nodeType)try{node.data=val}catch(e){}else elem||(elem=data.element=node.parentNode),"textContent"in elem?elem.textContent=val:elem.innerText=val},visible:function(val,elem,data){elem.style.display=val?data.display:"none"},widget:noop},rwhitespace=/^\s+$/,bindingHandlers=avalon.bindingHandlers={attr:function(data,vmodels){var text=data.value.trim(),simple=!0;text.indexOf(openTag)>-1&&text.indexOf(closeTag)>2&&(simple=!1,rexpr.test(text)&&""===RegExp.rightContext&&""===RegExp.leftContext&&(simple=!0,text=RegExp.$1)),data.handlerName="attr",parseExprProxy(text,vmodels,data,simple?null:scanExpr(data.value))},checked:function(data,vmodels){data.handlerName="checked",parseExprProxy(data.value,vmodels,data)},"class":function(data,vmodels){var rightExpr,oldStyle=data.param,text=data.value;if(data.handlerName="class",!oldStyle||isFinite(oldStyle)){data.param="";var noExpr=text.replace(rexprg,function(a){return Math.pow(10,a.length-1)}),colonIndex=noExpr.indexOf(":");if(-1===colonIndex)var className=text;else{if(className=text.slice(0,colonIndex),rightExpr=text.slice(colonIndex+1),parseExpr(rightExpr,vmodels,data),!data.evaluator)return log("debug: ms-class '"+(rightExpr||"").trim()+"' 不存在于VM中"),!1;data._evaluator=data.evaluator,data._args=data.args}var hasExpr=rexpr.test(className);hasExpr||(data._class=className),parseExprProxy("",vmodels,data,hasExpr?scanExpr(className):null)}else"class"===data.type&&parseExprProxy(text,vmodels,data)},duplex:function(data,vmodels){var elem=data.element,tagName=elem.tagName;if("function"==typeof duplexBinding[tagName]&&(data.changed=getBindingCallback(elem,"data-duplex-changed",vmodels)||noop,parseExpr(data.value,vmodels,data,"duplex"),data.evaluator&&data.args)){var form=elem.form;form&&form.msValidate&&form.msValidate(elem),data.bound=function(type,callback){elem.addEventListener?elem.addEventListener(type,callback,!1):elem.attachEvent("on"+type,callback);var old=data.rollback;data.rollback=function(){avalon.unbind(elem,type,callback),old&&old()}},duplexBinding[elem.tagName](elem,data.evaluator.apply(null,data.args),data)}},repeat:function(data,vmodels){var list,type=data.type;parseExpr(data.value,vmodels,data),"repeat"!==type&&log("warning:建议使用ms-repeat代替ms-each, ms-with, ms-repeat只占用一个标签并且性能更好");var elem=data.callbackElement=data.parent=data.element;data.getter=function(){return this.evaluator.apply(0,this.args||[])},data.proxies=[];var freturn=!0;try{list=data.getter();var xtype=getType(list);("object"==xtype||"array"==xtype)&&(freturn=!1)}catch(e){}var template=hyperspace.cloneNode(!1);if("repeat"===type){var startRepeat=DOC.createComment("ms-repeat-start"),endRepeat=DOC.createComment("ms-repeat-end");data.element=data.parent=elem.parentNode,data.startRepeat=startRepeat,data.endRepeat=endRepeat,elem.removeAttribute(data.name),data.parent.replaceChild(endRepeat,elem),data.parent.insertBefore(startRepeat,endRepeat),template.appendChild(elem)}else for(var node;node=elem.firstChild;)3===node.nodeType&&rwhitespace.test(node.data)?elem.removeChild(node):template.appendChild(node);data.template=template,data.rollback=function(){bindingExecutors.repeat.call(data,"clear");var endRepeat=data.endRepeat,parent=data.parent;parent.insertBefore(data.template,endRepeat||null),endRepeat&&(parent.removeChild(endRepeat),parent.removeChild(data.startRepeat),data.element=data.callbackElement)};var arr=data.value.split(".")||[];if(arr.length>1){arr.pop();for(var v,n=arr[0],i=0;v=vmodels[i++];)if(v&&v.hasOwnProperty(n)&&v[n][subscribers]){v[n][subscribers].push(data);break}}if(!freturn){data.callbackName="data-"+type+"-rendered",data.handler=bindingExecutors.repeat,data.$outer={};var check0="$key",check1="$val";Array.isArray(list)&&(check0="$first",check1="$last");for(var p,i=0;p=vmodels[i++];)if(p.hasOwnProperty(check0)&&p.hasOwnProperty(check1)){data.$outer=p;break}if(node=template.firstChild,data.fastRepeat=!!node&&1===node.nodeType&&template.lastChild===node&&!node.attributes["ms-controller"]&&!node.attributes["ms-important"],list[subscribers]&&list[subscribers].push(data),Array.isArray(list)||"each"===type)data.handler("add",0,list);else{var pool=withProxyPool[list.$id];if(!pool){withProxyCount++,pool=withProxyPool[list.$id]={};for(var key in list)list.hasOwnProperty(key)&&"hasOwnProperty"!==key&&!function(k,v){pool[k]=createWithProxy(k,v,{}),pool[k].$watch("$val",function(val){list[k]=val})}(key,list[key])}data.handler("append",list,pool)}}},html:function(data,vmodels){parseExprProxy(data.value,vmodels,data)},"if":function(data,vmodels){var elem=data.element;elem.removeAttribute(data.name),data.placehoder||(data.msInDocument=data.placehoder=DOC.createComment("ms-if")),data.vmodels=vmodels,parseExprProxy(data.value,vmodels,data)},on:function(data,vmodels){var value=data.value,four="$event";if(value.indexOf("(")>0&&value.indexOf(")")>-1){var matched=(value.match(rdash)||["",""])[1].trim();(""===matched||"$event"===matched)&&(four=void 0,value=value.replace(rdash,""))}else four=void 0;data.hasArgs=four,parseExprProxy(value,vmodels,data,four)},visible:function(data,vmodels){var elem=data.element;if(!supportDisplay&&!root.contains(elem))var display=parseDisplay(elem.tagName);display=display||avalon(elem).css("display"),data.display="none"===display?parseDisplay(elem.tagName):display,parseExprProxy(data.value,vmodels,data)
},widget:function(data,vmodels){var args=data.value.match(rword),elem=data.element,widget=args[0];"$"!==args[1]&&args[1]||(args[1]=widget+setTimeout("1")),data.value=args.join(",");var constructor=avalon.ui[widget];if("function"==typeof constructor){vmodels=elem.vmodels||vmodels;for(var v,optName=args[2]||widget,i=0;v=vmodels[i++];)if(v.hasOwnProperty(optName)&&"object"==typeof v[optName]){var nearestVM=v;break}if(nearestVM){var vmOptions=nearestVM[optName];vmOptions=vmOptions.$model||vmOptions;var id=vmOptions[widget+"Id"];"string"==typeof id&&(args[1]=id)}var widgetData=avalon.getWidgetData(elem,args[0]);data[widget+"Id"]=args[1],data[widget+"Options"]=avalon.mix({},constructor.defaults,vmOptions||{},widgetData),elem.removeAttribute("ms-widget");var vmodel=constructor(elem,data,vmodels)||{};if(data.evaluator=noop,elem.msData["ms-widget-id"]=vmodel.$id||"",vmodel.hasOwnProperty("$init")&&vmodel.$init(),vmodel.hasOwnProperty("$remove")){var offTree=function(){vmodel.$remove(),elem.msData={},delete VMODELS[vmodel.$id]};supportMutationEvents?elem.addEventListener("DOMNodeRemoved",function(e){e.target!==this||this.msRetain||offTree()}):(elem.offTree=offTree,launchImpl(elem))}}else vmodels.length&&(elem.vmodels=vmodels)}},supportMutationEvents=W3C&&DOC.implementation.hasFeature("MutationEvents","2.0");"hover,active".replace(rword,function(method){bindingHandlers[method]=bindingHandlers["class"]}),"with,each".replace(rword,function(name){bindingHandlers[name]=bindingHandlers.repeat}),"disabled,enabled,readonly,selected".replace(rword,function(name){bindingHandlers[name]=bindingHandlers.checked}),bindingHandlers.data=bindingHandlers.text=bindingHandlers.html,"title,alt,src,value,css,include,href".replace(rword,function(name){bindingHandlers[name]=bindingHandlers.attr});var duplexBinding=bindingHandlers.duplex;duplexBinding.INPUT=function(element,evaluator,data){function removeFn(e){var key=e.keyCode;91===key||key>15&&19>key||key>=37&&40>=key||("cut"===e.type?avalon.nextTick(updateVModel):updateVModel())}var fixType=data.param,type=element.type,bound=data.bound,$elem=avalon(element),firstTigger=!1,composing=!1,callback=function(value){firstTigger=!0,data.changed.call(this,value)},compositionStart=function(){composing=!0},compositionEnd=function(){composing=!1},updateVModel=function(){if(!composing){var val=element.oldValue=element.value;$elem.data("duplex-observe")!==!1&&(evaluator(val),callback.call(element,val))}};if(data.handler=function(){var val=evaluator();val!==element.value&&(element.value=val+"")},"checkbox"===type&&"radio"===fixType&&(type="radio"),"radio"===type)data.handler=function(){element.defaultChecked=element.checked=/bool|text/.test(fixType)?evaluator()+""===element.value:!!evaluator()},updateVModel=function(){if($elem.data("duplex-observe")!==!1){var val=element.value;"text"===fixType?evaluator(val):"bool"===fixType?(val="true"===val,evaluator(val)):(val=!element.defaultChecked,evaluator(val),element.checked=val),callback.call(element,val)}},bound(fixType?"click":"mousedown",updateVModel);else if("checkbox"===type)updateVModel=function(){if($elem.data("duplex-observe")!==!1){var method=element.checked?"ensure":"remove",array=evaluator();Array.isArray(array)?avalon.Array[method](array,element.value):avalon.error("ms-duplex位于checkbox时要求对应一个数组"),callback.call(element,array)}},data.handler=function(){var array=[].concat(evaluator());element.checked=array.indexOf(element.value)>=0},bound(W3C?"change":"click",updateVModel);else{var event=element.attributes["data-duplex-event"]||element.attributes["data-event"]||{};if(event=event.value,"change"===event)bound("change",updateVModel);else if(W3C&&9!==DOC.documentMode)bound("input",updateVModel),bound("compositionstart",compositionStart),bound("compositionend",compositionEnd);else{var events=["keyup","paste","cut","change"];events.forEach(function(type){element.attachEvent("on"+type,removeFn)}),data.rollback=function(){events.forEach(function(type){element.detachEvent("on"+type,removeFn)})}}}element.onTree=onTree,launch(element),element.oldValue=element.value,registerSubscriber(data);var timer=setTimeout(function(){firstTigger||callback.call(element,element.value),clearTimeout(timer)},31)};var TimerID,ribbon=[],launch=noop;if(Object.getOwnPropertyNames)try{var inputProto=HTMLInputElement.prototype,oldSetter=Object.getOwnPropertyDescriptor(inputProto,"value").set;Object.defineProperty(inputProto,"value",{set:newSetter})}catch(e){launch=launchImpl}duplexBinding.SELECT=function(element,evaluator,data){function updateVModel(){if($elem.data("duplex-observe")!==!1){var val=$elem.val();val+""!==element.oldValue&&(evaluator(val),element.oldValue=val+""),data.changed.call(element,val)}}var $elem=avalon(element);data.handler=function(){var curValue=evaluator();curValue=curValue&&curValue.$model||curValue,curValue=Array.isArray(curValue)?curValue.map(String):curValue+"",curValue+""!==element.oldValue&&($elem.val(curValue),element.oldValue=curValue+"")},data.bound("change",updateVModel);var innerHTML=0/0,id=setInterval(function(){var currHTML=element.innerHTML;currHTML===innerHTML?(clearInterval(id),registerSubscriber(data),data.changed.call(element,evaluator())):innerHTML=currHTML},20)},duplexBinding.TEXTAREA=duplexBinding.INPUT;var eventHooks=avalon.eventHooks;"onmouseenter"in root||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(origType,fixType){eventHooks[origType]={type:fixType,deel:function(elem,fn){return function(e){var t=e.relatedTarget;return t&&(t===elem||16&elem.compareDocumentPosition(t))?void 0:(delete e.type,e.type=origType,fn.call(elem,e))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(construct,fixType){window[construct]&&!eventHooks.animationend&&(eventHooks.animationend={type:fixType})}),"oninput"in document.createElement("input")||(eventHooks.input={type:"propertychange",deel:function(elem,fn){return function(e){return"value"===e.propertyName?(e.type="input",fn.call(elem,e)):void 0}}}),void 0===document.onmousewheel&&(eventHooks.mousewheel={type:"DOMMouseScroll",deel:function(elem,fn){return function(e){e.wheelDelta=e.detail>0?-120:120,Object.defineProperty&&Object.defineProperty(e,"type",{value:"mousewheel"}),fn.call(elem,e)}}});var _splice=ap.splice,CollectionPrototype={_splice:_splice,_add:function(arr,pos){var oldLength=this.length;pos="number"==typeof pos?pos:oldLength;for(var added=[],i=0,n=arr.length;n>i;i++)added[i]=convert(arr[i]);return _splice.apply(this,[pos,0].concat(added)),notifySubscribers(this,"add",pos,added),this._stopFireLength?void 0:this._.length=this.length},_del:function(pos,n){var ret=this._splice(pos,n);return ret.length&&(notifySubscribers(this,"del",pos,n),this._stopFireLength||(this._.length=this.length)),ret},push:function(){ap.push.apply(this.$model,arguments);var n=this._add(arguments);return notifySubscribers(this,"index",n>2?n-2:0),n},pushArray:function(array){return this.push.apply(this,array)},unshift:function(){ap.unshift.apply(this.$model,arguments);var ret=this._add(arguments,0);return notifySubscribers(this,"index",arguments.length),ret},shift:function(){var el=this.$model.shift();return this._del(0,1),notifySubscribers(this,"index",0),el},pop:function(){var el=this.$model.pop();return this._del(this.length-1,1),el},splice:function(a){a=resetNumber(a,this.length);var removed=_splice.apply(this.$model,arguments),ret=[];return this._stopFireLength=!0,removed.length&&(ret=this._del(a,removed.length),arguments.length<=2&&notifySubscribers(this,"index",0)),arguments.length>2&&this._add(aslice.call(arguments,2),a),this._stopFireLength=!1,this._.length=this.length,ret},contains:function(el){return-1!==this.indexOf(el)},size:function(){return this._.length},remove:function(el){return this.removeAt(this.indexOf(el))},removeAt:function(index){return index>=0?this.splice(index,1):[]},clear:function(){return this.$model.length=this.length=this._.length=0,notifySubscribers(this,"clear",0),this},removeAll:function(all){if(Array.isArray(all))all.forEach(function(el){this.remove(el)},this);else if("function"==typeof all)for(var i=this.length-1;i>=0;i--){var el=this[i];all(el,i)&&this.splice(i,1)}else this.clear()},ensure:function(el){return this.contains(el)||this.push(el),this},set:function(index,val){if(index>=0){var valueType=getType(val);val&&val.$model&&(val=val.$model);var target=this[index];if("object"===valueType)for(var i in val)target.hasOwnProperty(i)&&(target[i]=val[i]);else"array"===valueType?target.clear().push.apply(target,val):target!==val&&(this[index]=val,this.$model[index]=val,notifySubscribers(this,"set",index,val))}return this}};"sort,reverse".replace(rword,function(method){CollectionPrototype[method]=function(){var aaa=this.$model,bbb=aaa.slice(0),sorted=!1;ap[method].apply(aaa,arguments);for(var i=0,n=bbb.length;n>i;i++){var a=aaa[i],b=bbb[i];if(!isEqual(a,b)){sorted=!0;var index=bbb.indexOf(a,i),remove=this._splice(index,1)[0],remove2=bbb.splice(index,1)[0];this._splice(i,0,remove),bbb.splice(i,0,remove2),notifySubscribers(this,"move",index,i)}}return bbb=void 0,sorted&&notifySubscribers(this,"index",0),this}});var queryComments=DOC.createTreeWalker?function(parent){for(var comment,tw=DOC.createTreeWalker(parent,NodeFilter.SHOW_COMMENT,null,null),ret=[];comment=tw.nextNode();)ret.push(comment);return ret}:function(parent){return parent.getElementsByTagName("!")},watchEachOne=oneObject("$index,$first,$last"),eachProxyPool=[],rscripts=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,raimg=/^<(a|img)\s/i,ron=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,ropen=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,rjavascripturl=/\s+(src|href)(?:=("javascript[^"]*"|'javascript[^']*'))?/gi,rsurrogate=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rnoalphanumeric=/([^\#-~| |!])/g,filters=avalon.filters={uppercase:function(str){return str.toUpperCase()},lowercase:function(str){return str.toLowerCase()},truncate:function(target,length,truncation){return length=length||30,truncation=void 0===truncation?"...":truncation,target.length>length?target.slice(0,length-truncation.length)+truncation:String(target)},camelize:camelize,sanitize:function(str){return str.replace(rscripts,"").replace(ropen,function(a){return raimg.test(a)&&(a=a.replace(rjavascripturl,"")),a.replace(ron," ").replace(/\s+/g," ")})},escape:function(html){return String(html).replace(/&/g,"&amp;").replace(rsurrogate,function(value){var hi=value.charCodeAt(0),low=value.charCodeAt(1);return"&#"+(1024*(hi-55296)+(low-56320)+65536)+";"}).replace(rnoalphanumeric,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(number,symbol){return symbol=symbol||"￥",symbol+avalon.filters.number(number)},number:function(number,decimals,dec_point,thousands_sep){number=(number+"").replace(/[^0-9+\-Ee.]/g,"");var n=isFinite(+number)?+number:0,prec=isFinite(+decimals)?Math.abs(decimals):0,sep=thousands_sep||",",dec=dec_point||".",s="",toFixedFix=function(n,prec){var k=Math.pow(10,prec);return""+Math.round(n*k)/k};return s=(prec?toFixedFix(n,prec):""+Math.round(n)).split("."),s[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep)),(s[1]||"").length<prec&&(s[1]=s[1]||"",s[1]+=new Array(prec-s[1].length+1).join("0")),s.join(dec)}};!new function(){function toInt(str){return parseInt(str,10)}function padNumber(num,digits,trim){var neg="";for(0>num&&(neg="-",num=-num),num=""+num;num.length<digits;)num="0"+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim){return function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12===offset&&(value=12),padNumber(value,size,trim)}}function dateStrGetter(name,shortForm){return function(date,formats){var value=date["get"+name](),get=(shortForm?"SHORT"+name:name).toUpperCase();return formats[get][value]}}function timeZoneGetter(date){var zone=-1*date.getTimezoneOffset(),paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)}function ampmGetter(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]}function jsonStringToDate(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=toInt(match[9]+match[10]),tzMin=toInt(match[9]+match[11])),dateSetter.call(date,toInt(match[1]),toInt(match[2])-1,toInt(match[3]));var h=toInt(match[4]||0)-tzHour,m=toInt(match[5]||0)-tzMin,s=toInt(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}var DATE_FORMATS={yyyy:dateGetter("FullYear",4),yy:dateGetter("FullYear",2,0,!0),y:dateGetter("FullYear",1),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:ampmGetter,Z:timeZoneGetter},DATE_FORMATS_SPLIT=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,NUMBER_STRING=/^\d+$/,R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,rfixFFDate=/^(\d+)-(\d+)-(\d{4})$/,rfixIEDate=/^(\d+)\s+(\d+),(\d{4})$/;filters.date=function(date,format){var fn,match,locate=filters.date.locate,text="",parts=[];if(format=format||"mediumDate",format=locate[format]||format,"string"==typeof date){if(NUMBER_STRING.test(date))date=toInt(date);else{var trimDate=date.trim();(trimDate.match(rfixFFDate)||trimDate.match(rfixIEDate))&&(date=RegExp.$3+"/"+RegExp.$1+"/"+RegExp.$2),date=jsonStringToDate(date)}date=new Date(date)}if("number"==typeof date&&(date=new Date(date)),"date"===getType(date)){for(;format;)match=DATE_FORMATS_SPLIT.exec(format),match?(parts=parts.concat(match.slice(1)),format=parts.pop()):(parts.push(format),format=null);return parts.forEach(function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,locate):value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}};var locate={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d ah:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"ah:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};locate.SHORTMONTH=locate.MONTH,filters.date.locate=locate};var innerRequire,modules=avalon.modules={"ready!":{exports:avalon},avalon:{exports:avalon,state:2}};!new function(){function cleanUrl(url){return(url||"").replace(/[?#].*/,"")}function getCurrentScript(base){var stack;try{a.b.c()}catch(e){stack=e.stack,!stack&&window.opera&&(stack=(String(e).match(/of linked script \S+/g)||[]).join(" "))}if(stack)return stack=stack.split(/[@ ]/g).pop(),stack="("===stack[0]?stack.slice(1,-1):stack.replace(/\s/,""),stack.replace(/(:\d+)?:\d+$/i,"");for(var node,nodes=(base?DOC:head).getElementsByTagName("script"),i=nodes.length;node=nodes[--i];)if((base||node.className===subscribers)&&"interactive"===node.readyState)return node.className=node.src}function checkCycle(deps,nick){for(var id in deps)if("司徒正美"===deps[id]&&2!==modules[id].state&&(id===nick||checkCycle(modules[id].deps,nick)))return!0}function checkDeps(){loop:for(var id,i=loadings.length;id=loadings[--i];){var obj=modules[id],deps=obj.deps;for(var key in deps)if(ohasOwn.call(deps,key)&&2!==modules[key].state)continue loop;2!==obj.state&&(loadings.splice(i,1),fireFactory(obj.id,obj.args,obj.factory),checkDeps())}}function checkFail(node,onError,fuckIE){var id=cleanUrl(node.src);return node.onload=node.onreadystatechange=node.onerror=null,onError||fuckIE&&!modules[id].state?(setTimeout(function(){head.removeChild(node),node=null}),void log("debug: 加载 "+id+" 失败"+onError+" "+!modules[id].state)):!0}function loadResources(url,parent,ret,shim){if("ready!"===url||modules[url]&&2===modules[url].state)return url;var plugin;if(url=url.replace(/^\w+!/,function(a){return plugin=a.slice(0,-1),""}),plugin=plugin||"js",plugin=plugins[plugin]||noop,"object"==typeof kernel.shim[url]&&(shim=kernel.shim[url]),kernel.paths[url]&&(url=kernel.paths[url]),/^(\w+)(\d)?:.*/.test(url))ret=url;else{parent=parent.substr(0,parent.lastIndexOf("/"));var tmp=url.charAt(0);if("."!==tmp&&"/"!==tmp)ret=basepath+url;else if("./"===url.slice(0,2))ret=parent+url.slice(1);else if(".."===url.slice(0,2))for(ret=parent+"/"+url;rdeuce.test(ret);)ret=ret.replace(rdeuce,"");else"/"===tmp?ret=parent+url:avalon.error("不符合模块标识规则: "+url)}url=cleanUrl(ret);var ext=plugin.ext;return ext&&url.slice(0-ext.length)!==ext&&(ret+=ext),kernel.nocache&&(ret+=(-1===ret.indexOf("?")?"?":"&")+(new Date-0)),plugin(ret,shim)}function loadJS(url,id,callback){var node=DOC.createElement("script");node.className=subscribers,node[W3C?"onload":"onreadystatechange"]=function(){if(W3C||/loaded|complete/i.test(node.readyState)){var factory=factorys.pop();factory&&factory.delay(id),callback&&callback(),checkFail(node,!1,!W3C)&&log("debug: 已成功加载 "+url)}},node.onerror=function(){checkFail(node,!0)},node.src=url,head.insertBefore(node,head.firstChild),log("debug: 正准备加载 "+url)}function fireFactory(id,deps,factory){for(var d,i=0,array=[];d=deps[i++];)array.push(modules[d].exports);var module=Object(modules[id]),ret=factory.apply(window,array);return module.state=2,void 0!==ret&&(modules[id].exports=ret),ret}var basepath,loadings=[],factorys=[];plugins.js=function(url,shim){var id=cleanUrl(url);return modules[id]||(modules[id]={id:id,exports:{}},shim?innerRequire(shim.deps||"",function(){loadJS(url,id,function(){modules[id].state=2,shim.exports&&(modules[id].exports="function"==typeof shim.exports?shim.exports():window[shim.exports]),innerRequire.checkDeps()})}):loadJS(url,id)),id},plugins.css=function(url){var id=url.replace(/(#.+|\W)/g,"");if(!DOC.getElementById(id)){var node=DOC.createElement("link");node.rel="stylesheet",node.href=url,node.id=id,head.insertBefore(node,head.firstChild)}},plugins.css.ext=".css",plugins.js.ext=".js",plugins.text=function(url){var xhr=getXHR(),id=url.replace(/[?#].*/,"");return modules[id]={},xhr.onreadystatechange=function(){if(4===xhr.readyState){var status=xhr.status;status>399&&600>status?avalon.error(url+" 对应资源不存在或没有开启 CORS"):(modules[id].state=2,modules[id].exports=xhr.responseText,innerRequire.checkDeps())}},xhr.open("GET",url,!0),"withCredentials"in xhr&&(xhr.withCredentials=!0),xhr.setRequestHeader("X-Requested-With","XMLHttpRequest"),xhr.send(),id};var cur=getCurrentScript(!0);cur||(cur=avalon.slice(DOC.scripts).pop().src);var url=cleanUrl(cur);basepath=kernel.base=url.slice(0,url.lastIndexOf("/")+1);var rdeuce=/\/\w+\/\.\./;innerRequire=avalon.require=function(list,factory,parent){var deps={},args=[],dn=0,cn=0,id=parent||"callback"+setTimeout("1");parent=parent||basepath,String(list).replace(rword,function(el){var url=loadResources(el,parent);url&&(dn++,modules[url]&&2===modules[url].state&&cn++,deps[url]||(args.push(url),deps[url]="司徒正美"))}),modules[id]={id:id,factory:factory,deps:deps,args:args,state:1},dn===cn?fireFactory(id,args,factory):loadings.unshift(id),checkDeps()},innerRequire.define=function(id,deps,factory){var args=aslice.call(arguments);if("string"==typeof id)var _id=args.shift();"function"==typeof args[0]&&args.unshift([]);var name=modules[_id]&&modules[_id].state>=1?_id:cleanUrl(getCurrentScript());!modules[name]&&_id&&(modules[name]={id:name,factory:factory,state:1}),factory=args[1],factory.id=_id,factory.delay=function(d){args.push(d);var isCycle=!0;try{isCycle=checkCycle(modules[d].deps,d)}catch(e){}isCycle&&avalon.error(d+"模块与之前的模块存在循环依赖，请不要直接用script标签引入"+d+"模块"),delete factory.delay,innerRequire.apply(null,args)},name?factory.delay(name,args):factorys.push(factory)},innerRequire.define.amd=modules,innerRequire.config=kernel,innerRequire.checkDeps=checkDeps};var ready=W3C?"DOMContentLoaded":"readystatechange";"complete"===DOC.readyState?setTimeout(fireReady):W3C?(DOC.addEventListener(ready,fireReady),window.addEventListener("load",fireReady)):(DOC.attachEvent("onreadystatechange",function(){"complete"===DOC.readyState&&fireReady()}),window.attachEvent("onload",fireReady),root.doScroll&&doScrollCheck()),avalon.config({loader:!0}),avalon.ready=function(fn){innerRequire("ready!",fn)},avalon.ready(function(){function drainQueue(){var fn=handlerQueue.shift();fn&&(fn(),handlerQueue.length&&avalon.nextTick())}if(window.VBArray&&!window.setImmediate){var handlerQueue=[];avalon.nextTick=function(callback){"function"==typeof callback&&handlerQueue.push(callback);var node=DOC.createElement("script");node.onreadystatechange=function(){drainQueue(),node.onreadystatechange=null,head.removeChild(node),node=null},head.appendChild(node)}}avalon.scan(DOC.body)})}(document);var Bezier=function(){"use strict";var DEFAULT_DURATION=400,solveEpsilon=function(duration){return 1/(200*duration)},unitBezier=function(p1x,p1y,p2x,p2y){var cx=3*p1x,bx=3*(p2x-p1x)-cx,ax=1-cx-bx,cy=3*p1y,by=3*(p2y-p1y)-cy,ay=1-cy-by,sampleCurveX=function(t){return((ax*t+bx)*t+cx)*t},sampleCurveY=function(t){return((ay*t+by)*t+cy)*t},sampleCurveDerivativeX=function(t){return(3*ax*t+2*bx)*t+cx},solveCurveX=function(x,epsilon){var t0,t1,t2,x2,d2,i;for(t2=x,i=0;8>i;i++){if(x2=sampleCurveX(t2)-x,Math.abs(x2)<epsilon)return t2;if(d2=sampleCurveDerivativeX(t2),Math.abs(d2)<1e-6)break;t2-=x2/d2}if(t0=0,t1=1,t2=x,t0>t2)return t0;if(t2>t1)return t1;for(;t1>t0;){if(x2=sampleCurveX(t2),Math.abs(x2-x)<epsilon)return t2;x>x2?t0=t2:t1=t2,t2=.5*(t1-t0)+t0}return t2},solve=function(x,epsilon){return sampleCurveY(solveCurveX(x,epsilon))};return function(x,duration){return solve(x,solveEpsilon(+duration||DEFAULT_DURATION))}};return{linear:unitBezier(0,0,1,1),ease:unitBezier(.25,.1,.25,1),easeIn:unitBezier(.42,0,1,1),easeOut:unitBezier(0,0,.58,1),easeInOut:unitBezier(.42,0,.58,1),unitBezier:unitBezier,cubicBezier:function(p1x,p1y,p2x,p2y,x,duration){return unitBezier(p1x,p1y,p2x,p2y)(x,duration)}}}();~function(){function getElementsByClassName(cn){if("querySelector"in document&&"function"==typeof document.querySelector)return document.querySelectorAll("."+cn);if("getElementsByClassName"in document&&"function"==typeof document.getElementsByClassName)return document.getElementsByClassName(cn);for(elements=document.getElementsByTagName("*"),pattern=new RegExp("(^|\\s)"+cn+"(\\s|$)"),i=0;i<elements.length;i++)pattern.test(elements[i].className)&&results.push(elements[i])}var ui={};ui.getComputedStyle=function(elem,pro){return pro?window.getComputedStyle(elem,null).getPropertyValue(pro):window.getComputedStyle(elem,null)};var ndP0=(document.body.scrollTop,getElementsByClassName("parallax0")[0]),ndP1=getElementsByClassName("parallax1")[0],ndP2=getElementsByClassName("parallax2")[0],topEdge=0;ndP0.style.top=0,ndP1.style.top=0,ndP2.style.top=0;var cardinal=(window.innerHeight,[1,1.5,1.8]);avalon.define("www_uiguide",function(vm){function cb(){var child=getFirstNode(this);if(child){var monthNum=child.className.match(/tree__item--m(\d+)/)[1],ndTarget=getElementsByClassName("month--m"+monthNum)[0],oStyle=ui.getComputedStyle(child),viewTop=getElementViewTop(child);ndTarget.style.left=hasClass(child,"tree__item--right")?getRandom(120,250)+"px":parseInt(oStyle.getPropertyValue("width"),10)+getRandom(120,250)+"px",ndTarget.style.top=(viewTop-topEdge)*(cardinal[1]-1)+getRandom(viewTop,viewTop+parseInt(oStyle.getPropertyValue("height"),10)-parseInt(ui.getComputedStyle(ndTarget,"height"),10))+"px",index++,nlNodeToScroll.push(ndP0),nlNodeToScroll.push(ndP1),nlNodeToScroll.push(ndP2)}}function hasClass(nd,cn){return new RegExp("(^|s*)"+cn+"(s*|$)").test(nd.className)}function getRandom(from,to){return from+Math.random()*(-from+to)}function getFirstNode(nd){for(var nlChild=nd.childNodes,i=0;i<nlChild.length;i++)if(1===nlChild.item(i).nodeType)return nlChild.item(i)}function getElementViewTop(element){for(var actualTop=element.offsetTop,current=element.offsetParent;null!==current;)actualTop+=current.offsetTop,current=current.offsetParent;return actualTop}function scroll(){var nd,scrollTop=parseInt(document.body.scrollTop,10);if(!(nlNodeToScroll.length<1))for(var i=0;i<nlNodeToScroll.length;i++)nd=nlNodeToScroll[i],nd.style.top=-(scrollTop*cardinal[i])+"px"}function supportFeature(feature){var b=document.body||document.documentElement,style=b.style,v=[],f=feature;if("string"==typeof style[feature])return!0;f=f.charAt(0).toUpperCase()+f.substr(1);for(var i=0;i<v.length;i++)if("string"==typeof style[v[i]+f])return!0;return!1}function setFrame(cb,frameNum){timer=window.requestAnimationFrame&&!frameNum?window.requestAnimationFrame(function(){cb(),timer=window.requestAnimationFrame(arguments.callee)}):window.setTimeout(function(){cb(),window.setTimeout(arguments.callee,1e3/60)},1e3*(frameNum||1)/60)}function clearFrame(id){window.cancelAnimationFrame?window.cancelAnimationFrame(id):window.clearTimeout(id)}var timer,supportTransition=!supportFeature("transition"),index=0,months=[],circles=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34],nlNodeToScroll=[],duration=800,storeScrollTop=document.body.scrollTop;for(var i in window.indexData)indexData.hasOwnProperty(i)&&months.push({key:i,item:indexData[i]});vm.circles=circles,months.sort(function(a,b){return b.key+a.key}),vm.months=months,vm.cb=cb,vm.circleCb=function(){for(var circles=getElementsByClassName("circle"),i=0;i<circles.length;i++)circles[i].style.top=(i+1)*getRandom(270,540)+"px"},vm.outerHeight=ui.getComputedStyle(ndP0,"height"),setFrame(function(){vm.outerHeight=ui.getComputedStyle(ndP0,"height")},50);var timingFun;timingFun=Bezier.unitBezier(.18,.73,.25,1),avalon.bind(window,"scroll",function(){function getPx(initTop,i){return isNaN(+initTop)?void 0:(diffIndex=Math.min(((new Date).getTime()-startTime)/duration,1),target=initTop/cardinal[i]+timingFun(diffIndex,800)*(-scrollTop-initTop/cardinal[i]),delta>0?Math.max(target,-scrollTop):Math.min(target,-scrollTop))}var sTop=document.body.scrollTop,delta=storeScrollTop>sTop?-1:1;if(storeScrollTop=sTop,supportTransition)scroll();else{clearFrame(timer);for(var diffIndex,target,nd,scrollTop=parseInt(sTop,10),initTop=[],startTime=(new Date).getTime(),i=0;i<nlNodeToScroll.length;i++)initTop[i]=parseInt(nlNodeToScroll[i].style.top,10)||0;setFrame(function(){for(var i=0;i<nlNodeToScroll.length;i++)nd=nlNodeToScroll[i],nd.style.top=getPx(initTop[i],i)*cardinal[i]+"px"})}});var nowIndex=0;vm.nowIndex={};for(var i=0;i<months.length;i++)vm.nowIndex[months[i].key]=nowIndex,nowIndex+=months[i].item.length}),avalon.scan()}();